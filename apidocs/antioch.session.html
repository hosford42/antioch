<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>antioch.session : API documentation</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
    <script src="sorttable.js" type="text/javascript"></script>
    <script src="pydoctor.js" type="text/javascript"></script>
  </head>
  <body>
    <h1 class="module">a.session : module documentation</h1>
    <p>
      <span id="part">Part of <a href="antioch.html">antioch</a></span>
      <a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py">View Source</a>
      
    </p>
    <div>
      
    </div>
    <div>Database-resident web session support.</p>
<p>Notes About &quot;Infant&quot; Sessions:</p>
<p>Sessions will not be added to the session store until a second request 
is made providing the session cookie. Until that time, they are kept in the
INFANT_SESSIONS dict. This dict could get rather large, depending on how 
many of the bots you get are cookie-aware, and their requests may end up 
creating numerous fake sessions. It could be neccessary to purge the infant
session cache more frequently than the session store.</p>
<p>Another option for dealing with this is to simply not save the session 
unless a user_id is being set, because in our case that means the user must
support cookies. I'd rather this session code be more generally useful, 
though, and I like the idea of sessions for anonymous users.</p>
<p>If, on the other hand, you'd rather just leave everything in a 
relational database, or are running multiple web servers from the same DB, 
you probably will want to set QUARANTINE_INFANT_SESSIONS to False.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Variables</td><td class="fieldArg">COOKIE_KEY</td><td>the session cookie name
 (type: str
)</td></tr><tr><td></td><td class="fieldArg">CLEANUP_CHANCE</td><td>the odds that old sessions will be cleanup during this request
 (type: int
)</td></tr><tr><td></td><td class="fieldArg">QUARANTINE_INFANT_SESSIONS</td><td>should new sessions be quarantined until they are used a second time?
 (type: bool
)</td></tr><tr><td></td><td class="fieldArg">INFANT_SESSIONS</td><td>holding area for new sessions
 (type: dict(str =&gt; dict)
)</td></tr><tr><td></td><td class="fieldArg">INFANT_SESSION_TIMEOUT</td><td>if a session hasn't been verified in this long, remove it
 (type: int
)</td></tr></table></div>

    
    
    <div id="splitTables">
      <table class="children sortable" id="id185">
  
  <tr>
    <th>Line #</th>
    <th>Kind</th>
    <th>Name</th>
    <th>Docs</th>
  </tr>
<tr class="function">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L70">70</a></td>
    <td>Function</td>
    <td><a href="antioch.session.html#createSessionCookie">createSessionCookie</a></td>
    <td><span>Make a number based on current time, pid, remote ip</span></td>
  </tr><tr class="function">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L89">89</a></td>
    <td>Function</td>
    <td><a href="antioch.session.html#destroySession">destroySession</a></td>
    <td><span>Destroy the current session for this request.</span></td>
  </tr><tr class="function">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L104">104</a></td>
    <td>Function</td>
    <td><a href="antioch.session.html#updateSession">updateSession</a></td>
    <td><span>Update the access time and/or user_id for this session.</span></td>
  </tr><tr class="function">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L164">164</a></td>
    <td>Function</td>
    <td><a href="antioch.session.html#getSessionCredentials">getSessionCredentials</a></td>
    <td><span>Given a Nevow context object, return a SessionCredentials object.</span></td>
  </tr><tr class="interface">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L191">191</a></td>
    <td>Interface</td>
    <td><a href="antioch.session.IUserSessionStore.html">IUserSessionStore</a></td>
    <td><span class="undocumented">No interface docstring; 7/7 methods documented</span></td>
  </tr><tr class="class">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L255">255</a></td>
    <td>Class</td>
    <td><a href="antioch.session.InMemoryUserSessionStore.html">InMemoryUserSessionStore</a></td>
    <td><span>An IUserSessionStore that does not persist sessions between 
startups.</span></td>
  </tr><tr class="class">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L323">323</a></td>
    <td>Class</td>
    <td><a href="antioch.session.TransactionUserSessionStore.html">TransactionUserSessionStore</a></td>
    <td><span>An IUserSessionStore that uses a relational database while supporting 
custom authenticate verbs.</span></td>
  </tr><tr class="class">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L406">406</a></td>
    <td>Class</td>
    <td><a href="antioch.session.SessionRealm.html">SessionRealm</a></td>
    <td><span>This Realm will choose the appropriate delegate Resource</span></td>
  </tr><tr class="interface">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L441">441</a></td>
    <td>Interface</td>
    <td><a href="antioch.session.ISessionCredentials.html">ISessionCredentials</a></td>
    <td><span>I represent an opaque value indicating a web session.</span></td>
  </tr><tr class="class">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L454">454</a></td>
    <td>Class</td>
    <td><a href="antioch.session.SessionCredentials.html">SessionCredentials</a></td>
    <td><span>An opaque value indicating a web session.</span></td>
  </tr><tr class="class">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L477">477</a></td>
    <td>Class</td>
    <td><a href="antioch.session.SessionChecker.html">SessionChecker</a></td>
    <td><span>Validator for web logins.</span></td>
  </tr><tr class="function private">
    
    <td class="lineno"><a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L182">182</a></td>
    <td>Function</td>
    <td><a href="antioch.session.html#_cleanupInfantSessions">_cleanupInfantSessions</a></td>
    <td><span>Iterate through the infant session cache and remove expired 
sessions.</span></td>
  </tr>
  
</table>
      
      
    </div>
    
    
    

    <div class="function">
  <a name="antioch.session.createSessionCookie">
    
  </a>
  <a name="createSessionCookie">
    
  </a>
  <div class="functionHeader">
    
    def
    createSessionCookie(request=None):
    <a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L70" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Make a number based on current time, pid, remote ip and two random ints,
then hash with md5. This should be fairly unique and very difficult to 
guess.<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="antioch.session.destroySession">
    
  </a>
  <a name="destroySession">
    
  </a>
  <div class="functionHeader">
    @inlineCallbacks<br />
    def
    destroySession(pool, request):
    <a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L89" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Destroy the current session for this request.</p>
<p>Delete the session record and remove the session cookie.<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="antioch.session.updateSession">
    
  </a>
  <a name="updateSession">
    
  </a>
  <div class="functionHeader">
    @inlineCallbacks<br />
    def
    updateSession(pool, request, user=None):
    <a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L104" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Update the access time and/or user_id for this session.</p>
<p>This function will first attempt to find the session in the infant 
session cache, removing it (and saving it to DB) if found.</p>
<p>updateSession is also responsible for setting the session cookie if it 
doesn't yet exist.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">pool</td><td>the database connection to use.
 (type: <a 
href="antioch.session.IUserSessionStore.html"><code>IUserSessionStore</code></a>
)</td></tr><tr><td></td><td class="fieldArg">request</td><td>the current request.
 (type: <a 
href="http%3A//buildbot.divmod.org/apidocs/nevow.appserver.NevowRequest.html"><code>nevow.appserver.NevowRequest</code></a>
)</td></tr><tr><td></td><td class="fieldArg">user</td><td>the current user, if any
 (type: <code>txopenid.user.User</code>
)</td></tr></table></div>
  </div>
</div><div class="function">
  <a name="antioch.session.getSessionCredentials">
    
  </a>
  <a name="getSessionCredentials">
    
  </a>
  <div class="functionHeader">
    
    def
    getSessionCredentials(ctx):
    <a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L164" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Given a Nevow context object, return a SessionCredentials object.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName">Parameters</td><td class="fieldArg">ctx</td><td>the current context
 (type: <a 
href="http%3A//buildbot.divmod.org/apidocs/nevow.context.WebContext.html"><code>nevow.context.WebContext</code></a>
)</td></tr><tr class="fieldStart"><td class="fieldName">Returns</td><td colspan="2">the session credentials
 (type: <a 
href="antioch.session.SessionCredentials.html"><code>SessionCredentials</code></a>
or <a 
href="http%3A//twistedmatrix.com/documents/current/api/twisted.cred.credentials.Anonymous.html"><code>twisted.cred.credentials.Anonymous</code></a>
)</td></tr></table></div>
  </div>
</div><div class="function">
  <a name="antioch.session._cleanupInfantSessions">
    
  </a>
  <a name="_cleanupInfantSessions">
    
  </a>
  <div class="functionHeader">
    
    def
    _cleanupInfantSessions():
    <a href="https://github.com/philchristensen/antioch/blob/master/src/antioch/session.py#L182" class="functionSourceLink">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    <div>Iterate through the infant session cache and remove expired 
sessions.<table class="fieldTable"></table></div>
  </div>
</div>
    <address>
      <a href="index.html">API Documentation</a> for <a href="http://philchristensen.github.com/antioch">antioch</a>, generated by <a href="http://codespeak.net/~mwh/pydoctor/">pydoctor</a> at 2010-12-10 15:11:17.
    </address>
  </body>
</html>